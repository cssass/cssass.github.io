<!DOCTYPE html>
<html lang="zh-cn">
  <head><!-- hexo injector head_begin start --><style type="text/css">.douban-card-block {
    display: flex;
    justify-content: center;
    align-items: center;
    width: 100%;
    max-height: 400px;
}

.douban-card {
    display: flex;
    margin: 30px 10px;
    padding: 15px;
    border-radius: 15px;
    position: relative;
    justify-content: center;
    align-items: center;
    overflow: hidden;
    color: antiquewhite;
    text-decoration: none;
}

.douban-card:hover {
    text-decoration: none;
}

.douban-card-bgimg {
    position: absolute;
    width: 115%;
    height: 115%;
    filter: blur(15px) brightness(0.6);
    background-size: 100%;
    background-position: center;
    background-repeat: no-repeat;
}

.douban-card-img {
    position: relative;
    height: 130px;
    width: 80px;
    background-size: 100%;
    background-position: center;
    background-repeat: no-repeat;
}

.douban-card-left:hover .douban-card-img {
    filter: blur(5px) brightness(0.6);
    transform: perspective(800px) rotateX(180deg);
}

.douban-card-left .douban-card-img {
    transition: all 500ms ease;
}

.douban-card-left {
    position: relative;
    display: flex;
    flex-direction: column;
    align-items: center;
}

.douban-card-left .douban-card-status {
    height: 130px;
    width: 80px;
    text-align: center;
    font-weight: bold;
    position: absolute;
    left: 0;
    top: 30%;
    transform: rotateX(180deg);
    backface-visibility: hidden;
    transition: all 500ms ease;
}

.douban-card-left:hover .douban-card-status {
    transform: perspective(800px) rotateX(0deg);
}

.douban-card-right {
    position: relative;
    display: flex;
    flex-direction: column;
    margin-left: 12px;
    font-size: 16px;
    font-family: "Courier New", Courier, monospace;
    line-height: 1.3;
    color: antiquewhite;
}

.douban-card-item {
    margin-top: 4px;
}
</style><!-- hexo injector head_begin end -->
    <meta charset="utf8" />
    <meta name="viewport" content="initial-scale=1.0, width=device-width" />
    <title>
      
        mouseenter/mouseleave事件和delegate方法的实现 | Mr.Drive2Far
      
    </title>
    <meta name="description" content=""/>
    <meta name="keywords" content=""/>
    
      <link rel="apple-touch-icon"
            sizes="180x180"
            href="/images/apple-touch-icon.png"/>
    
    
      <link rel="icon"
            type="image/png"
            sizes="32x32"
            href="/images/favicon-32x32.png"/>
    
    
      <link rel="icon"
            type="image/png"
            sizes="16x16"
            href="/images/favicon-16x16.png"/>
    
    
      <link rel="mask-icon"
            href="/images/logo.svg"
            color=""/>
    
    
    <link rel="stylesheet" type="text/css" href="/css/layout.css"/>
    
    
    <script type="text/javascript" charset="utf-8" src="https://www.cssass.com/public/js/three.min.js"></script>
    

    
    
  <link rel="stylesheet" type="text/css" href="/css/post.css"/>
  <link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css"/>

  <!-- hexo injector head_end start --><style type="text/css">.runcode {zoom:1;}
.runcode p{margin:0;}
.runcode_text {display: block;height: 180px;width: 100%;color:#ccc;overflow-x:hidden;letter-spacing:1px;text-shadow:1px 1px 1px #111;font-family:Consolas,Fixedsys;padding:2px;font-size:13px;line-height:1.5em;background:#404040;border:3px inset #eee;}
.runcode_button{border:1px solid #ccc;font-size:16px;font-weight:bold;cursor: pointer;
	border-radius:3px;
	text-shadow:1px 1px 0 #eee;
	box-shadow:1px 0 1px #999;
	filter:progid:DXImageTransform.Microsoft.gradient(startColorstr=#eee, endColorstr=#aaa);
	background: linear-gradient(top, #eee, #ccc ,#aaa,#aaa,#aaa);
	background: -moz-linear-gradient(top, #eee, #ccc ,#aaa,#aaa,#aaa);
	background: -webkit-gradient(linear, 0 0, 0 100% , from(#eee),to(#aaa));
	background: -webkit-linear-gradient(0 0, #eee, #ccc ,#aaa,#aaa,#aaa);
}
</style><script type="text/javascript">var runcode = {};
runcode.open=function(element){
	var code = document.getElementById(element).value;
	var win = window.open("", "", "");
	win.opener = null;
	win.document.write(code);
	win.document.close();
}
runcode.copy=function(element){
	var codeobj = document.getElementById(element) ;
	if (window.clipboardData)
	{	
		window.clipboardData.setData("Text", codeobj.value);
	}else{
		codeobj.select(); 	
		codeobj.setSelectionRange(0, codeobj.value.length);
		document.execCommand('copy');
		setTimeout(function(){
			codeobj.blur()
		},300);
	}
}



</script><style type="text/css">
#postBody{position:relative;zoom:1;margin:0px auto;}
.pin{width:295px;float:left;list-style:none;}
.boxCont{
	position:relative;margin:15px;padding:10px;min-height:120px;border:1px solid #ccc;background:#eee;
	background: -webkit-gradient(linear, 0% 20%, 0% 92%, from(#fff), to(#f3f3f3), color-stop(.1,#fff));
	background: -webkit-linear-gradient(0 0 270deg, #f3f3f3, #f3f3f3 10%, #fff);
	background: -moz-linear-gradient(0 0 270deg, #f3f3f3, #f3f3f3 10%, #fff);
	background: -o-linear-gradient(0 0 270deg, #f3f3f3, #f3f3f3 10%, #fff);
	-webkit-border-radius: 60px / 5px;
	-moz-border-radius: 60px / 5px;
	border-radius:60px / 5px;
	-webkit-box-shadow: 0px 0px 35px rgba(0, 0, 0, 0.1) inset;
	-moz-box-shadow: 0px 0px 35px rgba(0, 0, 0, 0.1) inset;
	box-shadow: 0px 0px 35px rgba(0, 0, 0, 0.1) inset;
}
.boxCont .title{font-size: 18px;color:#19537D;}
.boxCont .desc{font-size: 12px;color: #65645F;}
.boxCont pre{background:transparent;margin:0;line-height: 200%;white-space:break-spaces;font-size:15px;font-family: 'PingFang SC';}
.boxCont:before{
	content: '';
	width: 50px;
	height: 50px;
	top:0; right:0;
	position:absolute;
	display: inline-block;
	z-index:-1;
	-webkit-box-shadow: 10px -10px 8px rgba(0, 0, 0, 0.2);
	-moz-box-shadow: 10px -10px 8px rgba(0, 0, 0, 0.2);
	box-shadow: 10px -10px 8px rgba(0, 0, 0, 0.2);
	-webkit-transform: rotate(2deg) translate(-14px,20px) skew(-20deg);
	-moz-transform: rotate(2deg) translate(-14px,20px) skew(-20deg);
	-o-transform: rotate(2deg) translate(-14px,20px) skew(-20deg);
	transform: rotate(2deg) translate(-14px,20px) skew(-20deg);
}
.boxCont:after{
	content: '';
	width: 100px;
	height: 100px;
	top:0; left:0;
	position:absolute;
	z-index:-1;
	display: inline-block;
	-webkit-box-shadow: -10px -10px 10px rgba(0, 0, 0, 0.2);
	-moz-box-shadow: -10px -10px 10px rgba(0, 0, 0, 0.2);
	box-shadow: -10px -10px 10px rgba(0, 0, 0, 0.2);
	-webkit-transform: rotate(2deg) translate(20px,25px) skew(20deg);
	-moz-transform: rotate(2deg) translate(20px,25px) skew(20deg);
	-o-transform: rotate(2deg) translate(20px,25px) skew(20deg);
	transform: rotate(2deg) translate(20px,25px) skew(20deg);
}</style><script type="text/javascript">function sort(){
	var h = [];
	var box = document.getElementsByClassName("pin");
	if(!box[0]) return;
	var el = box[0].parentElement;
	var minH = box[0].offsetHeight,
		boxW = box[0].offsetWidth,
		boxH,
		n = el.offsetWidth / boxW | 0;  //计算页面能排下多少Pin
		el.style.cssText = "height:500px;overflow-x:hidden;overflow-y:auto;"
		
	// el.style.width = n * boxW + "px";
	for(var i = 0; i < box.length; i++) {
		boxh = box[i].offsetHeight; //获取每个Pin的高度
		if(i < n) { //第一行Pin以浮动排列，不需绝对定位
			h[i] = boxh;
			box[i].style.position = '';
		} else {
			minH =  Math.min.apply({},h); //取得各列累计高度最低的一列
			minKey = getarraykey(h, minH);
			h[minKey] += boxh ; //加上新高度后更新高度值
			box[i].style.position = 'absolute';
			box[i].style.top = minH + 'px';
			box[i].style.left = (minKey * boxW) + 'px';
		}
	}
};
/* 返回数组中某一值的对应项数 */
function getarraykey(s, v) {
	for(k in s) {
		if(s[k] == v) {
			return k;
		}
	}
};

setTimeout(sort,100)

</script><!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="Mr.Drive2Far" type="application/atom+xml">
</head>
  <body>
    <div class="head">
      <div class="nav">
        <a id="nav-logo" href="/" class="nav-logo">
          
        </a>
        <input id="navBtn" type="checkbox"/>
        <div class="nav-menu">
          
            
              <a class="nav-menu-item" href="/developer">Developer</a>
            
              <a class="nav-menu-item" href="/scientist">Scientist</a>
            
              <a class="nav-menu-item" href="/economic">Economic</a>
            
              <a class="nav-menu-item" href="/essay">闲情偶寄</a>
            
          
        </div>
        <label class="nav-btn" for="navBtn"></label>
      </div>
    </div>
    <div class="body">
      
  <article class="post-content">
    <div class="post-inner">
      <div class="post-content__head">
        <div class="post-title">mouseenter/mouseleave事件和delegate方法的实现</div>
        <div class="post-info">
          
  
    <a href="/tags/DOM/" class="post-tag">#DOM</a>
  


          <span class="post-date">2011-12-18</span>
        </div>
      </div>
      <div id="postBody" class="post-content__body">
        <div id="tocAnchor" class="toc-anchor">
          <ol id="toc" class="post-toc">
            
          </ol>
        </div>
        
          <div class="post-gallery">
            
          </div>
        
        <p>众所周知，事件onmouseover和onmouseout有一个极其不好的问题，就是在绑定元素内部的子元素上滑动会反复触发事件，及执行绑定的方法。</p>
<p>而ie在很早的时候有提供了另一对事件：mouseenter和mouseleaver。顾名思义，就是只有当mouse滑进滑出绑定元素的时候，才会触发。</p>
<p>但是，这本来只是ie的私有属性，虽然已属于DOM3 Event草案当中，其他浏览器的支持率并不是很高，目前看来，Opera11.10已提供支持，而Firefox到10.0会提供支持，Webkit的暂无消息。<br>所以，如果想要用，我们得自己动手。</p>
<p>先搞一个通用的事件绑定函数：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">var addEvent = function( target,type,fn ) &#123;</span><br><span class="line">    if(target.addEventListener)</span><br><span class="line">    &#123;</span><br><span class="line">        target.addEventListener(type,fn,false);</span><br><span class="line">    &#125;</span><br><span class="line">    else if(target.attachEvent)</span><br><span class="line">    &#123;</span><br><span class="line">        target.attachEvent(&quot;on&quot; + type,fn);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line">var removeEvent = function(target,type,fn ) &#123;</span><br><span class="line">    if(target.addEventListener)</span><br><span class="line">    &#123;</span><br><span class="line">        target.removeEventListener(type,fn,false);</span><br><span class="line">    &#125;</span><br><span class="line">    else if(target.attachEvent)</span><br><span class="line">    &#123;</span><br><span class="line">        target.detachEvent(&quot;on&quot; + type,fn);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>我们的mouseenter&#x2F;leave是通过mouseover&#x2F;out来实现的，只需屏蔽mouseover&#x2F;out在元素内部触发时的事件传播即可。<br> <p><textarea class="runcode_text" id="runcode_7cbdae66-246c-48ad-b5a0-bbdcd49e5607"><!DOCTYPE html>
<html>
<head>
<meta charset="utf-8" />
<title>实现mouseenter、mouseleave事件</title>
<style>
.outer{padding:50px;background:#aaa;}
.inner{height:100px;background:#eee;}
</style>
</head>
<body>
<div id="outer" class="outer">
	只有移进移出外框的时候才执行方法。对内框操作不执行。click点击解除绑定。
	<div id="inner" class="inner"></div>
</div>
</body>
<script>
var $id=function(o){return document.getElementById(o) || o;}
var events = {}
events._mouseFn ={}; //保存“onmouseenter”和“onmouseleave”所绑定的方法
events._mouseHandle = function(fn){
	/* 转换方法，符合条件时才会执行 */
	var func = function(event){
		var target = event.target;
		var parent = event.relatedTarget; //在onmouseover/out操作中，相关的另一个节点
		while( parent && parent != this ){
			try{ parent = parent.parentNode; }
			catch(e){break;}
		}
		/* 只有当相关节点的父级不会是绑定的节点时（即二者不是父子的包含关系），才调用fn，否则不做处理 */
		( parent != this ) && (fn.call(target,event));
	};
	return func;
}
events.addEvent = function( obj,type,fn ) {
	if(obj.addEventListener)
    {
		if(obj.onmouseenter !== undefined){
			//for opera11，firefox10。他们也支持“onmouseenter”和“onmouseleave”，可以直接绑定
			obj.addEventListener(type,fn,false);
			return ;
		}
		if(type=="mouseenter" || type=="mouseleave" ){
			var eType = (type=="mouseenter") ? "mouseover" : "mouseout";
			var fnNew = events._mouseHandle(fn);
			obj.addEventListener(eType,fnNew,false);
			 /* 将方法存入events._mouseFn，以便以后remove */
			if(!events._mouseFn[obj]) events._mouseFn[obj] = {};
			if(!events._mouseFn[obj][eType]) events._mouseFn[obj][eType] = {};
				events._mouseFn[obj][eType][fn] = fnNew;
		}else{
			obj.addEventListener(type,fn,false);
		}
    }else if(obj.attachEvent)
    {
		// for ie
        obj.attachEvent("on" + type,fn);
    }
};
events.removeEvent = function(obj,type,fn ) {
    if(obj.addEventListener)
    {
		if(obj.onmouseenter !== undefined){
			obj.removeEventListener(type,fn,false);
			return ;
		}
		if(type=="mouseenter" || type=="mouseleave" ){
			var eType = (type=="mouseenter") ? "mouseover" : "mouseout";
			if(!events._mouseFn[obj][eType][fn]) return;
			obj.removeEventListener(eType,events._mouseFn[obj][eType][fn],false);
			events._mouseFn[obj][eType][fn] = null;
		}else{
			obj.removeEventListener(type,fn,false);
		}
    }
    else if(obj.attachEvent)
    {
        obj.detachEvent("on" + type,fn);
    }
};
(function(){
	/* 这里是演示demo 绑定解除事件 */
	var outer = $id("outer"),
		inner = $id("inner");
	events.addEvent(outer,"mouseenter",add);
	events.addEvent(outer,"mouseleave",add);
	events.addEvent(outer,"click",remove);
	function add(){
		var e = arguments[0] || window.event;
		var target = e.srcElement || e.target;
		inner.innerHTML = target.id + ' ' + e.type;
	}
	function remove(){
		events.removeEvent(outer,"mouseenter",add);
		events.removeEvent(outer,"mouseleave",add)
		inner.innerHTML = "click";
	}
})()
</script>
 </textarea><input type="button" value="Run" class="runcode_button" onclick="runcode.open('runcode_7cbdae66-246c-48ad-b5a0-bbdcd49e5607');" />&nbsp;<input type="button" value="Copy" class="runcode_button" onclick="runcode.copy('runcode_7cbdae66-246c-48ad-b5a0-bbdcd49e5607');" /></p><br>为了解除绑定，我们设计了一个events._mouseFn来保存绑定的方法，在解除操作时读取对应的方法进行解绑。因为事件可以绑定多个方法，我们需要保存对应的方法，以便之后对应解除。<br>当然如果这里如果按面向对象的思路实现，就可以各自保存，而不需要保持在同一个events._mouseFn对象下。但每绑定一个事件，都需实例化一个对象，显得很多余，所以不采用面向对象的模式。</p>
<p>接下来是文章的第二部分，我们来实现下jquery中提供的delegate方法。<br>（delegate是live方法的扩展版。delegate是基于live的，live是基于bind的。在jquery1.7中又被封装进了on方法。1.7中的on方法是一个很辽阔的方法。其实封装的越厉害，效率就越差了，这也是为什么我们选择自己做简单封装的原因，而不是使用jquery已封装好的）。<br>这个方法可以将想要绑定在子级元素上的事件方法，委托绑定在其父级上，用事件传播机制来触发执行。<br>这么做的好处有：<br>1：如果子级有n个并列元素需要绑定，绑子级需要绑n次，而将其绑定在父级上则只需绑定一次，这是很高效的。<br>2：如果子级元素有动态增加的话，新增元素是没有绑定过任何事件方法的。而如果之前选择的是绑定其父级，就不会有这个问题。<br> <p><textarea class="runcode_text" id="runcode_7f717bb9-3d2f-4655-b990-ea6921cbbe17"><!DOCTYPE html>
<html>
<head>
<meta charset="utf-8" />
<title>delegate委托绑定事件方法的实现</title>
<style>
.outer{padding:50px;background:#aaa;zoom:1;}
.inner{display:block;height:50px;margin:5px;background:#eee;border:1px solid #ccc;}
</style>
</head>
<body>
<div id="outer" class="outer">
	<div id="message">点击下面框体</div>
	<span class="inner">1:</span>
	<span class="inner">2:</span>
	<span class="inner">3:</span>
	<span class="inner">4:</span>
	<span class="inner">5:</span>
	<div id="unbind">点击解除绑定</div>
</div>
</body>
<script>
//一些通用方法
var $id=function(o){return document.getElementById(o) || o;}
var isDOMs = function(target){
	return target.length >= 0 && target !== window && !target.tagName;  //!target.tagName排除FORM,SELECT等元素
};
var hasClass = function(target,className){
	if(!target || !className) return false;
	if(target[0]) target = target[0];
	var pattern = new RegExp("(^|\\s)"+className+"(\\s|$)");
	return pattern.test(target.className);
}
//正式开始
window.events = {}
events._deleFn = {}; //保存delegate所绑定的方法
events._mouseFn ={}; //保存“onmouseenter”和“onmouseleave”所绑定的方法
events._ieFunc = {}; //由于保存在ie下绑定的方法
events._mouseHandle = function(fn){
	/* 实现mouseenter/leave 的转换方法，符合条件时才会执行 */
	var func = function(event){
		var target = event.target;
		var parent = event.relatedTarget; //在onmouseover/out操作中，相关的另一个节点
		while( parent && parent != this ){
			try{ parent = parent.parentNode; }
			catch(e){break;}
		}
		/* 只有当相关节点的父级不会是绑定的节点时（即二者不是父子的包含关系），才调用fn，否则不做处理 */
		( parent != this ) && (fn.call(target,event));
	};
	return func;
}
events._delegateHandle = function(obj,selector,fn){
	/* 实现delegate 的转换方法，符合条件时才会执行 */
	var func = function(event){
		var event = event || window.event;
		var target = event.srcElement || event.target;
		var parent = target;
		function contain(item,elmName){
			if(elmName.split('#')[1]){ //by id
				if(item.id && item.id === elmName.split('#')[1]) return true;
			}
			if(elmName.split('.')[1]){ //by class
				if(hasClass(item, elmName.split('.')[1])) return true;
			}
			if(item.tagName == elmName.toUpperCase())  return true; //by tagname
			return false;
		}
		while(parent){
			/* 如果触发的元素，属于(selector)元素的子级。 */
			if(obj == parent) return false; //触发元素是自己
			if(contain(parent,selector)){
				fn.call(obj,event);
				return;
			}
			parent = parent.parentNode;
		}
	};
	return func;
};
events.addEvent = function(target,type,fn){
	if (!target) return false;
	var add = function(obj){
		if(obj.addEventListener){
			obj.addEventListener(type,fn,false);
		}else{
			// for ie
			if(!events._ieFunc[obj]) events._ieFunc[obj] = {};
			if(!events._ieFunc[obj][type]) events._ieFunc[obj][type] = {};
			events._ieFunc[obj][type][fn] = function(){
				fn.apply(obj,arguments);
			};
			obj.attachEvent("on" + type,events._ieFunc[obj][type][fn]);
		}
	}
	if(isDOMs(target)) {
		for(var i=0, l = target.length; i < l; i++){
			add(target[i])
		}
	}else{
		add(target);
	}
};
events.removeEvent = function(target,type,fn) {
	if (!target) return false;
    var remove = function(obj){
    	if(obj.addEventListener){
			if(obj.onmouseenter !== undefined){
				obj.removeEventListener(type,fn,false);
				return ;
			}
			obj.removeEventListener(type,fn,false);
		}else{
			//for ie
			if(!events._ieFunc[obj] ||!events._ieFunc[obj][type] || !events._ieFunc[obj][type][fn]) return;
			obj.detachEvent("on" + type, events._ieFunc[obj][type][fn],false);
			events._ieFunc[obj][type][fn]={};
		}
    }
    if(isDOMs(target)) {
		for(var i=0, l = target.length; i < l; i++){
			remove(target[i])
		}
	}else{
		remove(target);
	}
};
events.delegate = function(obj,selector,type,fn){
	if (!obj || !selector) return false;
	var fnNew = events._delegateHandle(obj,selector,fn);
	events.addEvent(obj,type,fnNew);
	/* 将绑定的方法存入events._deleFn，以便之后解绑操作 */
	if(!events._deleFn[selector]) events._deleFn[selector] = {};
	if(!events._deleFn[selector][type]) events._deleFn[selector][type] = {};
	events._deleFn[selector][type][fn] = fnNew;
};
events.undelegate = function(obj,selector,type,fn){
	if (!obj || !selector || !events._deleFn[selector]) return false;
	var fnNew = events._deleFn[selector][type][fn];
	if(!fnNew) return;
	events.removeEvent(obj,type,fnNew);
	events._deleFn[selector][type][fn] = null;
};
(function(){
	/* 这里是演示demo*/
	var outer = $id("outer"),
		msg = $id("message");
	var add = function(){
		var e = arguments[0] || window.event;
		var target = e.srcElement || e.target;
		msg.innerHTML =  target.innerHTML + ' ' + e.type;
	}
	function color(){
		msg.style.color = "#c00"
	}
	function remove(){
		events.undelegate(outer,".inner","click",color);
		events.undelegate(outer,"#unbind","click",remove);
		msg.style.color = "#000"
		msg.innerHTML = "已解除绑定color方法.add方法仍在";
	}
	events.delegate(outer,".inner","click",add);
	events.delegate(outer,".inner","click",color);
	events.delegate(outer,"#unbind","click",remove);
})()
</script>
 </textarea><input type="button" value="Run" class="runcode_button" onclick="runcode.open('runcode_7f717bb9-3d2f-4655-b990-ea6921cbbe17');" />&nbsp;<input type="button" value="Copy" class="runcode_button" onclick="runcode.copy('runcode_7f717bb9-3d2f-4655-b990-ea6921cbbe17');" /></p><br>这里的实现思路是这样的：如果触发事件的元素，是你想要绑定的元素的子级（当然他肯定已是委托实际绑定元素的子级），就执行绑定的事件方法，否则方法就不执行，看上去就像方法没绑定过一样。<br>同实现onmouseenter一样，我们也设计了一个events._deleFn来用于后面的解绑方法undelegate的实现。<br>另外针对ie，我们还解决了两个问题：</p>
<ol>
<li>绑定方法内的this指向问题。我们用.apply执行绑定方法来解决。</li>
<li>使用apply调用绑定方法，就必须考虑如何解绑方法。原理和_mouseFn还有_deleFn一样。</li>
</ol>
<p>在使用delegate时，我们同样遇到了mouseover&#x2F;out的问题。<br>我们的解决方案是：不罗嗦，直接将mouseover&#x2F;out处理成mouseenter&#x2F;leave<br> <p><textarea class="runcode_text" id="runcode_db30e912-b757-40a9-aa0b-58a8c4e52b2b"><!DOCTYPE html>
<html>
<head>
<meta charset="utf-8" />
<title>delegate委托绑定事件方法的实现</title>
<style>
.outer{padding:50px;background:#aaa;zoom:1;}
.inner{display:block;height:50px;background:#eee;border:1px solid #ccc;}
</style>
</head>
<body>
<div id="outer" class="outer">
	<div id="message">划过下面框体</div>
	<span class="inner">1:</span>
	<span class="inner">2:</span>
	<span class="inner">3:</span>
	<span class="inner">4:</span>
	<span class="inner">5:</span>
	<div id="unbind">点击解除绑定</div>
</div>
</body>
<script>
var $id=function(o){return document.getElementById(o) || o;}
var isDOMs = function(target){
	return target.length >= 0 && target !== window && !target.tagName;  //!target.tagName排除FORM,SELECT等元素
};
window.events = {}
events._deleFn = {}; //保存delegate所绑定的方法
events._mouseFn ={}; //保存“onmouseenter”和“onmouseleave”所绑定的方法
events._ieFunc = {}; //由于保存在ie下绑定的方法
events._mouseHandle = function(fn){
	/* 实现mouseenter/leave 的转换方法，符合条件时才会执行 */
	var func = function(event){
		var target = event.target;
		var parent = event.relatedTarget; //在onmouseover/out操作中，相关的另一个节点
		while( parent && parent != this ){
			try{ parent = parent.parentNode; }
			catch(e){break;}
		}
		/* 只有当相关节点的父级不会是绑定的节点时（即二者不是父子的包含关系），才调用fn，否则不做处理 */
		( parent != this ) && (fn.call(target,event));
	};
	return func;
}
events._delegateHandle = function(obj,selector,fn){
	/* 实现delegate 的转换方法，符合条件时才会执行 */
	var func = function(event){
		var event = event || window.event;
		var target = event.srcElement || event.target;
		var parent = target;
		function contain(item,elmName){
			if(elmName.split('#')[1]){ //by id
				if(item.id && item.id === elmName.split('#')[1]) return true;
			}
			if(elmName.split('.')[1]){ //by class
				if(hasClass(item, elmName.split('.')[1])) return true;
			}
			if(item.tagName == elmName.toUpperCase())  return true; //by tagname
			return false;
		}
		while(parent){
			/* 如果触发的元素，属于(selector)元素的子级。 */
			if(obj == parent) return false; //触发元素是自己
			if(contain(parent,selector)){
				if(event.type == 'mouseover' || event.type == 'mouseout'){
					/*
					* 将mouseover/out直接处理成mouseenter/leave: 事件相关元素不属于绑定元素的子级，才绑定方法
					*/
					//事件相关元素。ie下使用toElement和fromElement，其他用relatedTarget。
					var related = event.relatedTarget || ((event.type == 'mouseout') ? event.toElement : event.fromElement);
					if(contain(target,selector) || contain(related,selector)) {
						/* 如果，触发元素或相关元素属于绑定元素(selector)。执行方法 */
						fn.call(obj,event);
						return;
					}
					while( related && !contain(related,selector)){
						  related = related.parentNode;
					}
					/* 事件相关元素，不属于绑定元素(selector)的子级，执行方法  */
					!contain(related,selector) && (fn.call(obj,event));
				}else{
					fn.call(obj,event);
				}
				return;
			}
			parent = parent.parentNode;
		}
	};
	return func;
};
events.addEvent = function(target,type,fn){
	if (!target) return false;
	var add = function(obj){
		if(obj.addEventListener){
			if(obj.onmouseenter !== undefined){
				//for opera11，firefox10。他们也支持“onmouseenter”和“onmouseleave”，可以直接绑定
				obj.addEventListener(type,fn,false);
				return ;
			}
			if(type=="mouseenter" || type=="mouseleave" ){
				var eType = (type=="mouseenter") ? "mouseover" : "mouseout";
				var fnNew = events._mouseHandle(fn);
				obj.addEventListener(eType,fnNew,false);
				 /* 将方法存入events._mouseFn，以便以后remove */
				if(!events._mouseFn[obj]) events._mouseFn[obj] = {};
				if(!events._mouseFn[obj][eType]) events._mouseFn[obj][eType] = {};
					events._mouseFn[obj][eType][fn] = fnNew;
			}else{
				obj.addEventListener(type,fn,false);
			}
		}else{
			// for ie
			if(!events._ieFunc[obj]) events._ieFunc[obj] = {};
			if(!events._ieFunc[obj][type]) events._ieFunc[obj][type] = {};
			events._ieFunc[obj][type][fn] = function(){
				fn.apply(obj,arguments);
			};
			obj.attachEvent("on" + type,events._ieFunc[obj][type][fn]);
		}
	}
	if(isDOMs(target)) {
		for(var i=0, l = target.length; i < l; i++){
			add(target[i])
		}
	}else{
		add(target);
	}
};
events.removeEvent = function(target,type,fn) {
	if (!target) return false;
    var remove = function(obj){
    	if(obj.addEventListener){
			if(obj.onmouseenter !== undefined){
				obj.removeEventListener(type,fn,false);
				return ;
			}
			if(type=="mouseenter" || type=="mouseleave" ){
				var eType = (type=="mouseenter") ? "mouseover" : "mouseout";
				if(!events._mouseFn[obj][eType][fn]) return;
				obj.removeEventListener(eType,events._mouseFn[obj][eType][fn],false);
				events._mouseFn[obj][eType][fn]={};
			}else{
				obj.removeEventListener(type,fn,false);
			}
		}else{
			//for ie
			if(!events._ieFunc[obj] ||!events._ieFunc[obj][type] || !events._ieFunc[obj][type][fn]) return;
			obj.detachEvent("on" + type, events._ieFunc[obj][type][fn],false);
			events._ieFunc[obj][type][fn]={};
		}
    }
    if(isDOMs(target)) {
		for(var i=0, l = target.length; i < l; i++){
			remove(target[i])
		}
	}else{
		remove(target);
	}
};
events.delegate = function(obj,selector,type,fn){
	if (!obj || !selector) return false;
	var fnNew = events._delegateHandle(obj,selector,fn);
	events.addEvent(obj,type,fnNew);
	/* 将绑定的方法存入events._deleFn，以便之后解绑操作 */
	if(!events._deleFn[selector]) events._deleFn[selector] = {};
	if(!events._deleFn[selector][type]) events._deleFn[selector][type] = {};
	events._deleFn[selector][type][fn] = fnNew;
};
events.undelegate = function(obj,selector,type,fn){
	if (!obj || !selector || !events._deleFn[selector]) return false;
	var fnNew = events._deleFn[selector][type][fn];
	if(!fnNew) return;
	events.removeEvent(obj,type,fnNew);
	events._deleFn[selector][type][fn] = null;
};
(function(){
	/* 这里是演示demo*/
	var outer = $id("outer"),
		msg = $id("message");
	events.delegate(outer,'span',"mouseover",add);
	events.delegate(outer,'span',"mouseout",add);
	events.delegate(outer,'#unbind',"click",remove);
	function add(){
		var e = arguments[0] || window.event;
		var target = e.srcElement || e.target;
		msg.innerHTML =  target.innerHTML + ' ' + e.type;
	}
	function remove(){
		events.undelegate(outer,'span',"mouseover",add);
		events.undelegate(outer,'span',"mouseout",add);
		events.undelegate(outer,'#unbind',"click",remove);
	}
})()
</script>
 </textarea><input type="button" value="Run" class="runcode_button" onclick="runcode.open('runcode_db30e912-b757-40a9-aa0b-58a8c4e52b2b');" />&nbsp;<input type="button" value="Copy" class="runcode_button" onclick="runcode.copy('runcode_db30e912-b757-40a9-aa0b-58a8c4e52b2b');" /></p><br>最后，整理一下，封装一个支持mouseenter 和 mouseleave事件，delegate方法 及其他们的解除绑定的方法的 功能函数库。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br></pre></td><td class="code"><pre><span class="line">window.events = &#123;&#125;</span><br><span class="line">events._deleFn = &#123;&#125;; //保存delegate所绑定的方法   </span><br><span class="line">events._mouseFn =&#123;&#125;; //保存“onmouseenter”和“onmouseleave”所绑定的方法</span><br><span class="line">events._ieFunc = &#123;&#125;; //由于保存在ie下绑定的方法</span><br><span class="line"> </span><br><span class="line">events._mouseHandle = function(fn)&#123;</span><br><span class="line">    /* 实现mouseenter/leave 的转换方法，符合条件时才会执行 */</span><br><span class="line">    var func = function(event)&#123;</span><br><span class="line">        var target = event.target;</span><br><span class="line">        var parent = event.relatedTarget; //在onmouseover/out操作中，相关的另一个节点</span><br><span class="line">        while( parent &amp;&amp; parent != this )&#123; </span><br><span class="line">            try&#123; parent = parent.parentNode; &#125;</span><br><span class="line">            catch(e)&#123;break;&#125;</span><br><span class="line">        &#125;</span><br><span class="line">        /* 只有当相关节点的父级不会是绑定的节点时（即二者不是父子的包含关系），才调用fn，否则不做处理 */</span><br><span class="line">        ( parent != this ) &amp;&amp; (fn.call(target,event));</span><br><span class="line">    &#125;;</span><br><span class="line">    return func;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">events._delegateHandle = function(obj,selector,fn)&#123;</span><br><span class="line">    /* 实现delegate 的转换方法，符合条件时才会执行 */</span><br><span class="line">    var func = function(event)&#123;</span><br><span class="line">        var event = event || window.event;</span><br><span class="line">        var target = event.srcElement || event.target;</span><br><span class="line">        var parent = target;</span><br><span class="line">        function contain(item,elmName)&#123;</span><br><span class="line">            if(elmName.split(&#x27;#&#x27;)[1])&#123; //by id</span><br><span class="line">                if(item.id &amp;&amp; item.id === elmName.split(&#x27;#&#x27;)[1]) return true;</span><br><span class="line">            &#125; </span><br><span class="line">            if(elmName.split(&#x27;.&#x27;)[1])&#123; //by class</span><br><span class="line">                if(hasClass(item, elmName.split(&#x27;.&#x27;)[1])) return true;</span><br><span class="line">            &#125;</span><br><span class="line">            if(item.tagName == elmName.toUpperCase())  return true; //by tagname</span><br><span class="line">            return false;</span><br><span class="line">        &#125;</span><br><span class="line"> </span><br><span class="line">        while(parent)&#123;</span><br><span class="line">            /* 如果触发的元素，属于(selector)元素的子级。 */</span><br><span class="line">            if(obj == parent) return false; //触发元素是自己</span><br><span class="line">            if(contain(parent,selector))&#123;</span><br><span class="line">                if(event.type == &#x27;mouseover&#x27; || event.type == &#x27;mouseout&#x27;)&#123;</span><br><span class="line">                    /*</span><br><span class="line">                    * 将mouseover/out直接处理成mouseenter/leave: 事件相关元素不属于绑定元素的子级，才绑定方法</span><br><span class="line">                    */</span><br><span class="line">                    //事件相关元素。ie下使用toElement和fromElement，其他用relatedTarget。</span><br><span class="line">                    var related = event.relatedTarget || ((event.type == &#x27;mouseout&#x27;) ? event.toElement : event.fromElement);</span><br><span class="line">                    if(contain(target,selector) || contain(related,selector)) &#123;</span><br><span class="line">                        /* 如果，触发元素或相关元素属于绑定元素(selector)。执行方法 */</span><br><span class="line">                        fn.call(obj,event);</span><br><span class="line">                        return;</span><br><span class="line">                    &#125;</span><br><span class="line">                    while( related &amp;&amp; !contain(related,selector))&#123; </span><br><span class="line">                          related = related.parentNode;</span><br><span class="line">                    &#125;</span><br><span class="line">                    /* 事件相关元素，不属于绑定元素(selector)的子级，执行方法  */</span><br><span class="line">                    !contain(related,selector) &amp;&amp; (fn.call(obj,event));</span><br><span class="line">                &#125;else&#123;</span><br><span class="line">                    fn.call(obj,event);</span><br><span class="line">                &#125;</span><br><span class="line">                return;</span><br><span class="line">            &#125;</span><br><span class="line">            parent = parent.parentNode;   </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    return func;</span><br><span class="line">&#125;;</span><br><span class="line"> </span><br><span class="line">events.addEvent = function(target,type,fn)&#123;</span><br><span class="line">    if (!target) return false;</span><br><span class="line">    var add = function(obj)&#123;</span><br><span class="line">        if(obj.addEventListener)&#123;   </span><br><span class="line">            if(obj.onmouseenter !== undefined)&#123;</span><br><span class="line">                //for opera11，firefox10。他们也支持“onmouseenter”和“onmouseleave”，可以直接绑定</span><br><span class="line">                obj.addEventListener(type,fn,false); </span><br><span class="line">                return ;</span><br><span class="line">            &#125;</span><br><span class="line">            if(type==&quot;mouseenter&quot; || type==&quot;mouseleave&quot; )&#123; </span><br><span class="line">                var eType = (type==&quot;mouseenter&quot;) ? &quot;mouseover&quot; : &quot;mouseout&quot;;</span><br><span class="line">                var fnNew = events._mouseHandle(fn);</span><br><span class="line">                obj.addEventListener(eType,fnNew,false);</span><br><span class="line">                 /* 将方法存入events._mouseFn，以便以后remove */</span><br><span class="line">                if(!events._mouseFn[obj]) events._mouseFn[obj] = &#123;&#125;;</span><br><span class="line">                if(!events._mouseFn[obj][eType]) events._mouseFn[obj][eType] = &#123;&#125;;</span><br><span class="line">                    events._mouseFn[obj][eType][fn] = fnNew;</span><br><span class="line">            &#125;else&#123;</span><br><span class="line">                obj.addEventListener(type,fn,false);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;else&#123;</span><br><span class="line">            // for ie</span><br><span class="line">            if(!events._ieFunc[obj]) events._ieFunc[obj] = &#123;&#125;;</span><br><span class="line">            if(!events._ieFunc[obj][type]) events._ieFunc[obj][type] = &#123;&#125;;</span><br><span class="line">            events._ieFunc[obj][type][fn] = function()&#123;</span><br><span class="line">                fn.apply(obj,arguments);</span><br><span class="line">            &#125;;</span><br><span class="line">            obj.attachEvent(&quot;on&quot; + type,events._ieFunc[obj][type][fn]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    if(isDOMs(target)) &#123;</span><br><span class="line">        for(var i=0, l = target.length; i &lt; l; i++)&#123;</span><br><span class="line">            add(target[i])</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">        add(target);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"> </span><br><span class="line">events.removeEvent = function(target,type,fn) &#123;</span><br><span class="line">    if (!target) return false;</span><br><span class="line">    var remove = function(obj)&#123;</span><br><span class="line">        if(obj.addEventListener)&#123;   </span><br><span class="line">            if(obj.onmouseenter !== undefined)&#123;</span><br><span class="line">                obj.removeEventListener(type,fn,false); </span><br><span class="line">                return ;</span><br><span class="line">            &#125;</span><br><span class="line">            if(type==&quot;mouseenter&quot; || type==&quot;mouseleave&quot; )&#123; </span><br><span class="line">                var eType = (type==&quot;mouseenter&quot;) ? &quot;mouseover&quot; : &quot;mouseout&quot;;</span><br><span class="line">                if(!events._mouseFn[obj][eType][fn]) return;</span><br><span class="line">                obj.removeEventListener(eType,events._mouseFn[obj][eType][fn],false);</span><br><span class="line">                events._mouseFn[obj][eType][fn]=&#123;&#125;;</span><br><span class="line">            &#125;else&#123;</span><br><span class="line">                obj.removeEventListener(type,fn,false);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;else&#123;</span><br><span class="line">            //for ie</span><br><span class="line">            if(!events._ieFunc[obj] ||!events._ieFunc[obj][type] || !events._ieFunc[obj][type][fn]) return;</span><br><span class="line">            obj.detachEvent(&quot;on&quot; + type, events._ieFunc[obj][type][fn],false);</span><br><span class="line">            events._ieFunc[obj][type][fn]=&#123;&#125;;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    if(isDOMs(target)) &#123;</span><br><span class="line">        for(var i=0, l = target.length; i &lt; l; i++)&#123;</span><br><span class="line">            remove(target[i])</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">        remove(target);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"> </span><br><span class="line">events.delegate = function(obj,selector,type,fn)&#123;</span><br><span class="line">    if (!obj || !selector) return false;</span><br><span class="line">    var fnNew = events._delegateHandle(obj,selector,fn);</span><br><span class="line">    events.addEvent(obj,type,fnNew);</span><br><span class="line">    /* 将绑定的方法存入events._deleFn，以便之后解绑操作 */</span><br><span class="line">    if(!events._deleFn[selector]) events._deleFn[selector] = &#123;&#125;;</span><br><span class="line">    if(!events._deleFn[selector][type]) events._deleFn[selector][type] = &#123;&#125;;</span><br><span class="line">    events._deleFn[selector][type][fn] = fnNew;</span><br><span class="line">&#125;;</span><br><span class="line"> </span><br><span class="line">events.undelegate = function(obj,selector,type,fn)&#123;</span><br><span class="line">    if (!obj || !selector || !events._deleFn[selector]) return false;</span><br><span class="line">    var fnNew = events._deleFn[selector][type][fn];</span><br><span class="line">    if(!fnNew) return;</span><br><span class="line">    events.removeEvent(obj,type,fnNew);</span><br><span class="line">    events._deleFn[selector][type][fn] = null;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
      </div>
    </div>
  </article>
  <div class="post__foot">
    
    <div class="post-nav">
  
    <a class="post-nav-item-left" href="/2012/01/04/%E5%A6%82%E4%BD%95%E8%8E%B7%E5%8F%96%E5%85%83%E7%B4%A0%E7%9A%84%E5%B0%BA%E5%AF%B8%E5%92%8C%E4%BD%8D%E7%BD%AE%E2%80%94%E2%80%94%E4%B8%A4%E4%B8%AA%E5%86%B7%E9%97%A8%E6%96%B9%E6%B3%95/">
      <div class="text-align">
        <svg t="1670570876164"
             class="icon"
             viewBox="0 0 1024 1024"
             width="16"
             height="16">
          <path d="M384 512L731.733333 202.666667c17.066667-14.933333 19.2-42.666667 4.266667-59.733334-14.933333-17.066667-42.666667-19.2-59.733333-4.266666l-384 341.333333c-10.666667 8.533333-14.933333 19.2-14.933334 32s4.266667 23.466667 14.933334 32l384 341.333333c8.533333 6.4 19.2 10.666667 27.733333 10.666667 12.8 0 23.466667-4.266667 32-14.933333 14.933333-17.066667 14.933333-44.8-4.266667-59.733334L384 512z" p-id="14596"/>
        </svg>
        <span class="text-small">上一篇</span>
      </div>
      <div>如何获取元素的尺寸和位置——两个冷门方法</div>
    </a>
  
  <div class="vhr"></div>
  
    <a class="post-nav-item-right" href="/2011/10/12/%E7%80%91%E5%B8%83%E6%B5%81%E5%B8%83%E5%B1%80%E5%8F%8A%E6%89%A9%E5%B1%95%E2%80%94%E2%80%94%E6%A0%BC%E5%AD%90%E5%9D%97%E7%9A%84%E6%99%BA%E8%83%BD%E5%A0%86%E7%A0%8C/">
      <div class="text-align">
        <span class="text-small">下一篇</span>
        <svg t="1670570876164"
             class="icon"
             viewBox="0 0 1024 1024"
             transform="scale(-1,-1)"
             width="16"
             height="16">
          <path d="M384 512L731.733333 202.666667c17.066667-14.933333 19.2-42.666667 4.266667-59.733334-14.933333-17.066667-42.666667-19.2-59.733333-4.266666l-384 341.333333c-10.666667 8.533333-14.933333 19.2-14.933334 32s4.266667 23.466667 14.933334 32l384 341.333333c8.533333 6.4 19.2 10.666667 27.733333 10.666667 12.8 0 23.466667-4.266667 32-14.933333 14.933333-17.066667 14.933333-44.8-4.266667-59.733334L384 512z" p-id="14596"/>
        </svg>
      </div>
      瀑布流布局及扩展——格子块的智能堆砌
    </a>
  
</div>

    
    
      <div id="gitalk-container"></div>
    
  </div>

    </div>
    <div class="foot">
      <div class="foot-inner">
        <div class="foot__head">
          
            <div class="foot-line">
              <div class="matts">海</div><div class="matts">内</div><div class="matts">存</div><div class="matts">知</div><div class="matts">己</div>
            </div>
          
            <div class="foot-line">
              <div class="matts">天</div><div class="matts">涯</div><div class="matts">若</div><div class="matts">比</div><div class="matts">邻</div>
            </div>
          
        </div>
        <div class="foot__body">
          
            <div class="foot-item">
              <div class="foot-item__head">朋友</div>
              <div class="foot-item__body">
                
                  <div class="text">
                    <img alt="link"
                         height="20px"
                         width="20px"
                         src="/images/icon/icon-link.svg"/>
                    <a class="foot-link" target="_blank" rel="noopener" href="https://github.com/hooozen/hexo-theme-tranquility">Theme Tranquility</a>
                  </div>
                
                <div class="text">
                  <img alt="link"
                       height="20px"
                       width="20px"
                       src="/images/icon/icon-link+.svg"/>
                  <a class="foot-link"
                     href="mailto:neoxone2@gmail.com?subject=%E7%94%B3%E8%AF%B7%20开过头先生的主页%20%E7%9A%84%E5%8F%8B%E9%93%BE%E4%BD%8D%E7%BD%AE">
                  申请友链</a>
                </div>
              </div>
            </div>
          
          
            <div class="foot-item">
              <div class="foot-item__head">账号</div>
              <div class="foot-item__body">
                
                  <div class="text">
                    <img alt="link" height="20px" width="20px" src="/images/logo-github.svg"/>
                    <a class="foot-link" target="_blank" rel="noopener" href="https://github.com/neoxone2">github</a>
                  </div>
                
                  <div class="text">
                    <img alt="link" height="20px" width="20px" src="/images/logo-zh.svg"/>
                    <a class="foot-link" target="_blank" rel="noopener" href="https://www.zhihu.com/people/neoxone">知乎</a>
                  </div>
                
              </div>
            </div>
          
          <div class="foot-item">
            <div class="foot-item__head">联系</div>
            <div class="foot-item__body">
              <div class="text">
                <img alt="link"
                     height="20px"
                     width="20px"
                     src="/images/icon/icon-email.svg"/>
                <a class="foot-link" href="mailto:neoxone2@gmail.com">neoxone2@gmail.com</a>
              </div>
            </div>
          </div>
        </div>
        <div class="copyright">
          <a href="https://www.cssass.com">Mr.Drive2Far</a> &nbsp;|&nbsp;由&nbsp;<a target="_blank" rel="noopener" href="https://hexo.io/">Hexo</a>&nbsp;及&nbsp;
          <svg width="20" height="20" viewBox="0 0 725 725">
            <path fill-rule="evenodd" fill="rgb(221, 221, 221)"
            d="M145.870,236.632 L396.955,103.578 L431.292,419.44 L156.600,522.53 L145.870,236.632 Z" />
            <path fill-rule="evenodd" fill="rgb(159, 159, 159)"
            d="M396.955,103.578 L564.345,234.486 L611.558,513.469 L431.292,419.44 L396.955,103.578 Z" />
            <path fill-rule="evenodd" fill="rgb(0, 0, 0)"
            d="M431.292,419.44 L611.558,513.469 L358.327,595.18 L156.600,522.53 L431.292,419.44 Z" />
          </svg>
          <a target="_blank" rel="noopener" href="https://github.com/hooozen/hexo-theme-tranquility">致远</a>&nbsp;驱动
          &nbsp;&nbsp;
          <a target="_blank" rel="noopener" href="http://beian.miit.gov.cn/">浙ICP备09004927号</a>
        </div>
      </div>
    </div>
    
      <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    
    
  <script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>
<script type="text/javascript">
  const param = JSON.parse('{"enable":true,"owner":"neoxone2","admin":"neoxone2","repo":"https://github.com/neoxone2/hexo_comments.git","clientID":"bc87b42f6b10a638d798","clientSecret":"bf741d0c9c429f37a79b88c8cabc3955ab64af41","distractionFreeMode":false,"proxy":"https://cors-anywhere.azm.workers.dev/https://github.com/login/oauth/access_token","language":"zh-CN"}')
  param.id = location.pathname
  const gitalk = new Gitalk(param)
  gitalk.render('gitalk-container')
</script>

  
  
    <script>
var WIDTH = 60,
    HEIGHT = 60;
var scene = new THREE.Scene();
var VIEW_ANGLE = 11,
  ASPECT = WIDTH / HEIGHT,
  NEAR = 0.1,
  FAR = 10000;
var camera = new THREE.PerspectiveCamera(VIEW_ANGLE, ASPECT, NEAR, FAR); 
  camera.position.set(0, 0, 1000); 
  scene.add(camera);
var geometry = new THREE.CubeGeometry( 100, 100, 100 ),
  material = new THREE.MeshLambertMaterial( { color: 0xeeeeee} );
var cube = new THREE.Mesh(geometry, material);
  cube.rotation.set(10,20,10); 
  scene.add(cube);
/* 灯光 */
var light = new THREE.DirectionalLight(0xFFFFFF); 
  light.position.set(-200, 500, 500).normalize();
  scene.add(light);
/* 渲染器 */
var renderer = new THREE.WebGLRenderer(); 
  renderer.setSize(WIDTH , HEIGHT);
  document.querySelector('#nav-logo').appendChild(renderer.domElement);

(function anime(){
  cube.rotation.x += 0.01;
  renderer.render(scene, camera); 
  return requestAnimationFrame(anime);
})()
</script>

  
  

  </body>
</html>
